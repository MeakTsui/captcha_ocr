<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gradient Text to PNG</title>
  <style>
    :root {
      --start: #60a5fa; /* from */
      --end: #c084fc;   /* to   */
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Inter, Helvetica, Arial, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', sans-serif;
      margin: 24px;
      color: #111827;
      background: #f8fafc;
    }
    .card {
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 16px;
      max-width: 840px;
      box-shadow: 0 1px 2px rgba(0,0,0,0.04);
    }
    .row { display: flex; gap: 12px; flex-wrap: wrap; align-items: end; }
    .field { display: flex; flex-direction: column; gap: 6px; }
    .field label { font-size: 12px; color: #6b7280; }
    input[type="number"], input[type="text"] {
      padding: 8px 10px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 14px;
      min-width: 120px;
      background: #fff;
    }
    button {
      appearance: none;
      border: 0;
      border-radius: 10px;
      padding: 10px 14px;
      background: linear-gradient(90deg, var(--start), var(--end));
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(96,165,250,0.25), 0 2px 8px rgba(192,132,252,0.25);
    }
    button:disabled { opacity: 0.6; cursor: not-allowed; }
    .preview {
      margin-top: 16px;
      border: 1px dashed #d1d5db;
      border-radius: 12px;
      background: conic-gradient(from 180deg at 50% 50%, #fafafa, #fff);
      padding: 12px;
    }
    .hint { color: #6b7280; font-size: 12px; }
    .gradient-text {
      font-size: 24px; /* 默认 24 */
      font-weight: 800;
      background: linear-gradient(90deg, var(--start), var(--end));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2 style="margin: 0 0 8px;">渐变文字导出 PNG（透明背景）</h2>
    <div class="hint">默认字体大小 24；支持指定导出图片宽高。</div>

    <div style="margin-top:12px;">
      <div class="row">
        <div class="field" style="flex:1; min-width: 220px;">
          <label>文字内容</label>
          <input id="text" type="text" value="Cricket AI" />
        </div>
        <div class="field">
          <label>字体大小 (px)</label>
          <input id="fontSize" type="number" min="6" max="512" value="24" />
        </div>
        <div class="field">
          <label style="display:flex; align-items:center; gap:8px;">
            <input id="bold" type="checkbox" /> 加粗
          </label>
        </div>
        <div class="field">
          <label>画布宽度 (px)</label>
          <input id="imgW" type="number" min="32" max="4096" value="600" />
        </div>
        <div class="field">
          <label>画布高度 (px)</label>
          <input id="imgH" type="number" min="32" max="4096" value="200" />
        </div>
        <div class="field">
          <label>左右内边距 (px)</label>
          <input id="padX" type="number" min="0" max="512" value="24" />
        </div>
        <div class="field">
          <label>文件名</label>
          <input id="fileName" type="text" value="cricket-ai.png" />
        </div>
      </div>
    </div>

    <div style="margin-top:12px; display:flex; gap:8px;">
      <button id="renderBtn">预览</button>
      <button id="saveBtn">保存为 PNG</button>
    </div>

    <div class="preview">
      <canvas id="canvas" width="600" height="200" style="width: 100%; height: auto; display:block; background: transparent;"></canvas>
      <div class="hint" style="margin-top:6px;">预览为透明背景。导出为 PNG 时也为透明。</div>
    </div>

    <div style="margin-top: 12px;">
      <span class="hint">HTML 中的示例渐变：</span>
      <span class="gradient-text">Cricket AI</span>
    </div>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);

    const canvas = $("canvas");
    const ctx = canvas.getContext("2d");

    function render() {
      const text = $("text").value || "Cricket AI";
      const fontSize = Math.max(6, parseInt($("fontSize").value || 24, 10));
      const imgW = Math.max(1, parseInt($("imgW").value || 600, 10));
      const imgH = Math.max(1, parseInt($("imgH").value || 200, 10));
      const padX = Math.max(0, parseInt($("padX").value || 24, 10));
      const isBold = $("bold").checked;

      // 设备像素比，保证高清导出
      const dpr = Math.max(1, Math.floor(window.devicePixelRatio || 1));
      canvas.width = imgW * dpr;
      canvas.height = imgH * dpr;
      canvas.style.width = imgW + 'px';
      canvas.style.height = imgH + 'px';

      ctx.reset?.();
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // 背景保持透明：不填充背景

      // 文本绘制设置
      const fontFamily = "Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial";
      ctx.font = `${isBold ? '700 ' : ''}${fontSize * dpr}px ${fontFamily}`;
      ctx.textBaseline = 'middle';
      ctx.textAlign = 'left';

      // 测量文本宽度，用于居中
      const metrics = ctx.measureText(text);
      const textW = metrics.width;
      const x = Math.max(padX * dpr, (canvas.width - textW) / 2); // 居中但保留左右内边距最小值
      const y = canvas.height / 2;

      // 创建左右方向渐变
      const grad = ctx.createLinearGradient(padX * dpr, 0, canvas.width - padX * dpr, 0);
      grad.addColorStop(0, '#60a5fa');
      grad.addColorStop(1, '#c084fc');

      ctx.fillStyle = grad;
      ctx.fillText(text, x, y);
    }

    function savePNG() {
      const name = ($("fileName").value || 'cricket-ai.png').replace(/\s+/g, '-');
      // 先确保预览使用的是当前参数
      render();
      canvas.toBlob((blob) => {
        if (!blob) return;
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = name.endsWith('.png') ? name : name + '.png';
        document.body.appendChild(a);
        a.click();
        a.remove();
        setTimeout(() => URL.revokeObjectURL(a.href), 0);
      }, 'image/png');
    }

    $("renderBtn").addEventListener('click', render);
    $("saveBtn").addEventListener('click', savePNG);
    $("bold").addEventListener('change', () => {
      // 同步示例文本加粗效果
      const sample = document.querySelector('.gradient-text');
      sample.style.fontWeight = $("bold").checked ? '800' : '400';
      render();
    });

    // 初次载入默认渲染
    // 默认与示例保持加粗外观
    $("bold").checked = true;
    const sample = document.querySelector('.gradient-text');
    if (sample) sample.style.fontWeight = '800';
    render();
  </script>
</body>
</html>
